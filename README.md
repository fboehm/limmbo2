
[![Travis-CI Build Status](https://travis-ci.org/fboehm/limmbo2.svg?branch=master)](https://travis-ci.org/fboehm/limmbo2)

<!-- README.md is generated from README.Rmd. Please edit that file -->
limmbo2
=======

The goal of limmbo2 is to ...

Installation
------------

First, be sure that you have python modules `limix` and `limmbo` installed:

``` bash
pip install limix
pip install limmbo
```

Once those two modules are successfully installed, you can proceed to install the limmbo2 R package:

``` r
# install.packages("devtools")
devtools::install_github("fboehm/limmbo2")
```

Example
-------

This is a basic example which shows you how to solve a common problem:

``` r
library(limmbo2)
pheno <- matrix(data = runif(300), nrow = 100, ncol = 3)
kinship <- diag(100)
t(chol(kinship)) -> chol_kin

prep_data(pheno, kinship) -> input_data

make_limmbo(input_data, TRUE, 10, 2) -> l_out
bs_covar_est(l_out, 1, 1) -> bs_out
bs_out2 <- lapply(FUN = convert_for_bscombine, X = bs_out)

combine_bs(bs_out2, l_out)
#> $nr_bs
#> [1] 14
#> 
#> $proc_time_combine_bs
#> [1] 0.027579
#> 
#> $results_fit_Cg
#> $results_fit_Cg[[1]]
#> [1] 0.4014722 0.3265067 0.2757809 0.3084417 0.1113620 0.2402369
#> 
#> $results_fit_Cg[[2]]
#> [1] 9.940764e-08
#> 
#> $results_fit_Cg[[3]]
#> $results_fit_Cg[[3]]$warnflag
#> [1] 0
#> 
#> $results_fit_Cg[[3]]$task
#> [1] "CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH"
#> 
#> $results_fit_Cg[[3]]$grad
#> [1] -1.801326e-04  4.396106e-05  3.309866e-04 -2.328558e-04  6.978672e-05
#> [6]  3.414357e-04
#> 
#> $results_fit_Cg[[3]]$funcalls
#> [1] 4
#> 
#> $results_fit_Cg[[3]]$nit
#> [1] 1
#> 
#> 
#> 
#> $proc_time_ind_bs
#>  [1] 1.128670 0.232314 0.249928 0.319345 0.241315 0.306250 0.261939
#>  [8] 0.233287 0.249621 0.257656 0.253955 0.278243 0.250692 0.251456
#> 
#> $results_fit_Cn
#> $results_fit_Cn[[1]]
#> [1] 0.4014722 0.3265067 0.2757809 0.3084417 0.1113620 0.2402369
#> 
#> $results_fit_Cn[[2]]
#> [1] 9.940764e-08
#> 
#> $results_fit_Cn[[3]]
#> $results_fit_Cn[[3]]$warnflag
#> [1] 0
#> 
#> $results_fit_Cn[[3]]$task
#> [1] "CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH"
#> 
#> $results_fit_Cn[[3]]$grad
#> [1] -1.801326e-04  4.396106e-05  3.309866e-04 -2.328558e-04  6.978672e-05
#> [6]  3.414357e-04
#> 
#> $results_fit_Cn[[3]]$funcalls
#> [1] 4
#> 
#> $results_fit_Cn[[3]]$nit
#> [1] 1
#> 
#> 
#> 
#> $Cg_all_bs
#> , , 1
#> 
#>            [,1]      [,2]
#>  [1,] 0.1653120 0.1238812
#>  [2,] 0.1827063 0.1314599
#>  [3,] 0.1653120 0.1238812
#>  [4,] 0.1612521 0.1238812
#>  [5,] 0.1653120 0.1314599
#>  [6,] 0.1612521 0.1238812
#>  [7,] 0.1827063 0.1311287
#>  [8,] 0.1653120 0.1238812
#>  [9,] 0.1827063 0.1311287
#> [10,] 0.1827063 0.1311287
#> [11,] 0.1653120 0.1238812
#> [12,] 0.1612521 0.1311287
#> [13,] 0.1653120 0.1238812
#> [14,] 0.1653120 0.1314599
#> 
#> , , 2
#> 
#>            [,1]      [,2]
#>  [1,] 0.1238812 0.1612521
#>  [2,] 0.1314599 0.1653120
#>  [3,] 0.1238812 0.1612521
#>  [4,] 0.1238812 0.1653120
#>  [5,] 0.1314599 0.1827063
#>  [6,] 0.1238812 0.1653120
#>  [7,] 0.1311287 0.1612521
#>  [8,] 0.1238812 0.1612521
#>  [9,] 0.1311287 0.1612521
#> [10,] 0.1311287 0.1612521
#> [11,] 0.1238812 0.1612521
#> [12,] 0.1311287 0.1827063
#> [13,] 0.1238812 0.1612521
#> [14,] 0.1314599 0.1827063
#> 
#> 
#> $Cn_average
#>           [,1]      [,2]      [,3]
#> [1,] 0.1612521 0.1311287 0.1238812
#> [2,] 0.1311287 0.1827063 0.1314599
#> [3,] 0.1238812 0.1314599 0.1653120
#> 
#> $proc_time_sum_ind_bs
#> [1] 4.514671
#> 
#> $Cn_fit
#>           [,1]      [,2]      [,3]
#> [1,] 0.1612799 0.1310834 0.1238308
#> [2,] 0.1310834 0.1827617 0.1314198
#> [3,] 0.1238308 0.1314198 0.1653515
#> 
#> $Cg_fit
#>           [,1]      [,2]      [,3]
#> [1,] 0.1612799 0.1310834 0.1238308
#> [2,] 0.1310834 0.1827617 0.1314198
#> [3,] 0.1238308 0.1314198 0.1653515
#> 
#> $Cn_all_bs
#> , , 1
#> 
#>            [,1]      [,2]
#>  [1,] 0.1653120 0.1238812
#>  [2,] 0.1827063 0.1314599
#>  [3,] 0.1653120 0.1238812
#>  [4,] 0.1612521 0.1238812
#>  [5,] 0.1653120 0.1314599
#>  [6,] 0.1612521 0.1238812
#>  [7,] 0.1827063 0.1311287
#>  [8,] 0.1653120 0.1238812
#>  [9,] 0.1827063 0.1311287
#> [10,] 0.1827063 0.1311287
#> [11,] 0.1653120 0.1238812
#> [12,] 0.1612521 0.1311287
#> [13,] 0.1653120 0.1238812
#> [14,] 0.1653120 0.1314599
#> 
#> , , 2
#> 
#>            [,1]      [,2]
#>  [1,] 0.1238812 0.1612521
#>  [2,] 0.1314599 0.1653120
#>  [3,] 0.1238812 0.1612521
#>  [4,] 0.1238812 0.1653120
#>  [5,] 0.1314599 0.1827063
#>  [6,] 0.1238812 0.1653120
#>  [7,] 0.1311287 0.1612521
#>  [8,] 0.1238812 0.1612521
#>  [9,] 0.1311287 0.1612521
#> [10,] 0.1311287 0.1612521
#> [11,] 0.1238812 0.1612521
#> [12,] 0.1311287 0.1827063
#> [13,] 0.1238812 0.1612521
#> [14,] 0.1314599 0.1827063
#> 
#> 
#> $nr_successful_bs
#> [1] 13
#> 
#> $Cg_average
#>           [,1]      [,2]      [,3]
#> [1,] 0.1612521 0.1311287 0.1238812
#> [2,] 0.1311287 0.1827063 0.1314599
#> [3,] 0.1238812 0.1314599 0.1653120
```
