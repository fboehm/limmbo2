
[![Travis-CI Build Status](https://travis-ci.org/fboehm/limmbo2.svg?branch=master)](https://travis-ci.org/fboehm/limmbo2)

<!-- README.md is generated from README.Rmd. Please edit that file -->
limmbo2
=======

The goal of limmbo2 is to ...

Installation
------------

You can install limmbo2 from github with:

``` r
# install.packages("devtools")
devtools::install_github("fboehm/limmbo2")
```

Example
-------

This is a basic example which shows you how to solve a common problem:

``` r
library(limmbo2)
pheno <- matrix(data = runif(300), nrow = 100, ncol = 3)
kinship <- diag(100)
t(chol(kinship)) -> chol_kin

prep_data(pheno, kinship) -> input_data

make_limmbo(input_data, TRUE, 10, 2) -> l_out
bs_covar_est(l_out, 1, 1) -> bs_out
bs_out2 <- lapply(FUN = convert_for_bscombine, X = bs_out)

combine_bs(bs_out2, l_out)
#> $nr_bs
#> [1] 14
#> 
#> $proc_time_combine_bs
#> [1] 0.026575
#> 
#> $results_fit_Cg
#> $results_fit_Cg[[1]]
#> [1] 0.42402710 0.31778115 0.25466734 0.31795647 0.09043277 0.24757384
#> 
#> $results_fit_Cg[[2]]
#> [1] 1.025214e-07
#> 
#> $results_fit_Cg[[3]]
#> $results_fit_Cg[[3]]$warnflag
#> [1] 0
#> 
#> $results_fit_Cg[[3]]$task
#> [1] "CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH"
#> 
#> $results_fit_Cg[[3]]$grad
#> [1] -2.089284e-04  9.073428e-05  3.551585e-04 -2.179350e-04  6.424529e-05
#> [6]  3.726174e-04
#> 
#> $results_fit_Cg[[3]]$funcalls
#> [1] 4
#> 
#> $results_fit_Cg[[3]]$nit
#> [1] 1
#> 
#> 
#> 
#> $proc_time_ind_bs
#>  [1] 1.115120 0.222633 0.219140 0.246799 0.220323 0.247789 0.614784
#>  [8] 0.219801 0.635733 0.698626 0.245155 0.277495 0.243722 0.238439
#> 
#> $results_fit_Cn
#> $results_fit_Cn[[1]]
#> [1] 0.42402710 0.31778115 0.25466734 0.31795647 0.09043277 0.24757384
#> 
#> $results_fit_Cn[[2]]
#> [1] 1.025214e-07
#> 
#> $results_fit_Cn[[3]]
#> $results_fit_Cn[[3]]$warnflag
#> [1] 0
#> 
#> $results_fit_Cn[[3]]$task
#> [1] "CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH"
#> 
#> $results_fit_Cn[[3]]$grad
#> [1] -2.089284e-04  9.073428e-05  3.551585e-04 -2.179350e-04  6.424529e-05
#> [6]  3.726174e-04
#> 
#> $results_fit_Cn[[3]]$funcalls
#> [1] 4
#> 
#> $results_fit_Cn[[3]]$nit
#> [1] 1
#> 
#> 
#> 
#> $Cg_all_bs
#> , , 1
#> 
#>            [,1]      [,2]
#>  [1,] 0.1706254 0.1348733
#>  [2,] 0.1658780 0.1241061
#>  [3,] 0.1706254 0.1348733
#>  [4,] 0.1798740 0.1348733
#>  [5,] 0.1706254 0.1241061
#>  [6,] 0.1798740 0.1348733
#>  [7,] 0.1658780 0.1347912
#>  [8,] 0.1706254 0.1348733
#>  [9,] 0.1658780 0.1347912
#> [10,] 0.1658780 0.1347912
#> [11,] 0.1706254 0.1348733
#> [12,] 0.1798740 0.1347912
#> [13,] 0.1706254 0.1348733
#> [14,] 0.1706254 0.1241061
#> 
#> , , 2
#> 
#>            [,1]      [,2]
#>  [1,] 0.1348733 0.1798740
#>  [2,] 0.1241061 0.1706254
#>  [3,] 0.1348733 0.1798740
#>  [4,] 0.1348733 0.1706254
#>  [5,] 0.1241061 0.1658780
#>  [6,] 0.1348733 0.1706254
#>  [7,] 0.1347912 0.1798740
#>  [8,] 0.1348733 0.1798740
#>  [9,] 0.1347912 0.1798740
#> [10,] 0.1347912 0.1798740
#> [11,] 0.1348733 0.1798740
#> [12,] 0.1347912 0.1658780
#> [13,] 0.1348733 0.1798740
#> [14,] 0.1241061 0.1658780
#> 
#> 
#> $Cn_average
#>           [,1]      [,2]      [,3]
#> [1,] 0.1798740 0.1347912 0.1348733
#> [2,] 0.1347912 0.1658780 0.1241061
#> [3,] 0.1348733 0.1241061 0.1706254
#> 
#> $proc_time_sum_ind_bs
#> [1] 5.445559
#> 
#> $Cn_fit
#>           [,1]      [,2]      [,3]
#> [1,] 0.1798990 0.1347478 0.1348222
#> [2,] 0.1347478 0.1659403 0.1240708
#> [3,] 0.1348222 0.1240708 0.1706672
#> 
#> $Cg_fit
#>           [,1]      [,2]      [,3]
#> [1,] 0.1798990 0.1347478 0.1348222
#> [2,] 0.1347478 0.1659403 0.1240708
#> [3,] 0.1348222 0.1240708 0.1706672
#> 
#> $Cn_all_bs
#> , , 1
#> 
#>            [,1]      [,2]
#>  [1,] 0.1706254 0.1348733
#>  [2,] 0.1658780 0.1241061
#>  [3,] 0.1706254 0.1348733
#>  [4,] 0.1798740 0.1348733
#>  [5,] 0.1706254 0.1241061
#>  [6,] 0.1798740 0.1348733
#>  [7,] 0.1658780 0.1347912
#>  [8,] 0.1706254 0.1348733
#>  [9,] 0.1658780 0.1347912
#> [10,] 0.1658780 0.1347912
#> [11,] 0.1706254 0.1348733
#> [12,] 0.1798740 0.1347912
#> [13,] 0.1706254 0.1348733
#> [14,] 0.1706254 0.1241061
#> 
#> , , 2
#> 
#>            [,1]      [,2]
#>  [1,] 0.1348733 0.1798740
#>  [2,] 0.1241061 0.1706254
#>  [3,] 0.1348733 0.1798740
#>  [4,] 0.1348733 0.1706254
#>  [5,] 0.1241061 0.1658780
#>  [6,] 0.1348733 0.1706254
#>  [7,] 0.1347912 0.1798740
#>  [8,] 0.1348733 0.1798740
#>  [9,] 0.1347912 0.1798740
#> [10,] 0.1347912 0.1798740
#> [11,] 0.1348733 0.1798740
#> [12,] 0.1347912 0.1658780
#> [13,] 0.1348733 0.1798740
#> [14,] 0.1241061 0.1658780
#> 
#> 
#> $nr_successful_bs
#> [1] 13
#> 
#> $Cg_average
#>           [,1]      [,2]      [,3]
#> [1,] 0.1798740 0.1347912 0.1348733
#> [2,] 0.1347912 0.1658780 0.1241061
#> [3,] 0.1348733 0.1241061 0.1706254
```
